package com.atomguard.velocity.module.exploit;

import com.atomguard.velocity.module.antiddos.RateLimiter;

import java.util.UUID;

/**
 * Tab-complete flood saldırı engelleyici.
 */
public class TabCompleteFloodBlocker {

    private final RateLimiter rateLimiter;

    public TabCompleteFloodBlocker(int maxPerSecond) {
        this.rateLimiter = new RateLimiter(maxPerSecond, maxPerSecond);
    }

    public boolean allowTabComplete(UUID playerId) {
        return rateLimiter.tryAcquire(playerId.toString());
    }

    public void cleanup() { rateLimiter.cleanup(); }
}
